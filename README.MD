# Nucleus - Event-Driven E-Commerce Backend

A production-grade backend system built with Go, following Clean Architecture principles and enterprise-level best practices.

## ğŸ—ï¸ Architecture

- **Clean Architecture**: Separation of concerns with clearly defined layers
- **Event-Driven**: Using RabbitMQ for commands and Kafka for events
- **Microservices Ready**: Designed for scalability and maintainability
- **Cloud Native**: Containerized with Docker and Kubernetes ready

## ğŸ› ï¸ Tech Stack

- **Language**: Go 1.22+
- **Web Framework**: Gin
- **Database**: PostgreSQL
- **Cache**: Redis
- **Message Queue**: RabbitMQ
- **Event Streaming**: Kafka
- **Authentication**: Keycloak (OAuth2/OIDC)
- **Monitoring**: Prometheus + Grafana
- **Logging**: Structured logs with Loki
- **API Documentation**: Swagger/OpenAPI
- **Container**: Docker & Docker Compose

## ğŸ“ Project Structure

```
nucleus/
â”œâ”€â”€ cmd/                    # Application entrypoints
â”‚   â”œâ”€â”€ api/               # REST API server
â”‚   â””â”€â”€ worker/            # Background workers
â”œâ”€â”€ internal/              # Private application code
â”‚   â”œâ”€â”€ domain/            # Enterprise business rules
â”‚   â”œâ”€â”€ application/       # Application business rules
â”‚   â”œâ”€â”€ infrastructure/    # Frameworks and drivers
â”‚   â””â”€â”€ interfaces/        # Interface adapters
â”œâ”€â”€ pkg/                   # Public packages
â”œâ”€â”€ configs/               # Configuration files
â”œâ”€â”€ deployments/           # Deployment configurations
â”œâ”€â”€ scripts/               # Utility scripts
â”œâ”€â”€ tests/                 # Test suites
â””â”€â”€ docs/                  # Documentation
```

## ğŸš€ Getting Started

### Prerequisites

- Go 1.22 or higher
- Docker and Docker Compose
- Make (optional but recommended)

### Quick Start

1. Clone the repository:
```bash
git clone https://github.com/vashafaris/nucleus.git
cd nucleus
```

2. Set up the environment:
```bash
make setup
```

3. Start all services:
```bash
make docker-up
```

4. Run the application:
```bash
make run
```

The API will be available at http://localhost:8080

### Available Services

- **API**: http://localhost:8080
- **Keycloak**: http://localhost:8180
- **RabbitMQ Management**: http://localhost:15672 (user: nucleus, password: rabbitmq123)
- **Prometheus**: http://localhost:9090
- **Grafana**: http://localhost:3000 (user: admin, password: admin123)

## ğŸ“ Development

### Common Commands

```bash
# Install dependencies
make deps

# Run tests
make test

# Run linter
make lint

# Format code
make fmt

# Generate mocks
make mocks

# Build the application
make build

# Generate Swagger docs
make swagger
```

### Running Locally

```bash
# Copy environment variables
cp .env.example .env

# Start dependencies
make docker-up

# Run the application
make run
```

### Database Migrations

```bash
# Run migrations
make migrate-up

# Rollback migrations
make migrate-down

# Seed database
make seed
```

## ğŸ§ª Testing

The project includes three levels of testing:

- **Unit Tests**: Test individual components in isolation
- **Integration Tests**: Test component interactions
- **E2E Tests**: Test complete user flows

Run all tests:
```bash
make test
```

Run with coverage:
```bash
make test-coverage
```

## ğŸ“Š Monitoring

### Metrics
- Prometheus metrics available at `/metrics`
- Pre-configured Grafana dashboards
- Application metrics: request latency, error rates, etc.

### Logging
- Structured JSON logging
- Centralized log aggregation with Loki
- Log levels: debug, info, warn, error

### Health Checks
- Liveness: `/health/live`
- Readiness: `/health/ready`

## ğŸ”’ Security

- OAuth2/OIDC authentication with Keycloak
- JWT token validation
- Role-based access control (RBAC)
- Rate limiting
- CORS configuration
- Security headers

## ğŸ“š API Documentation

Swagger documentation is available at:
- http://localhost:8080/swagger/index.html

To regenerate docs:
```bash
make swagger
```

## ğŸš¢ Deployment

### Docker

```bash
# Build Docker image
make docker-build

# Run with Docker Compose
make docker-up
```

### Kubernetes

Kubernetes manifests are available in `deployments/k8s/`

## ğŸ¤ Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.

## ğŸ‘¥ Author

- GitHub: [@vashafaris](https://github.com/vashafaris)